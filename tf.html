<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="stylesheet" type="text/css" href="styles.css" />
  <title>BAU-Ops Tools</title>
</head>
<body>

<div>
  <ul>
    <li><a href="cease.html">Cease Billing Format</a></li>
    <li><a href="port.html">Billing Format</a></li>
    <li><a href="ipms.html">IPMS Format</a></li>
    <li><a href="devoli.html">Devoli Format</a></li>
    <li><a href="list.html">List for BAU Ops</a></li>
    <li><a href="range.html">Extract Range Format</a></li>
    <li><a href="number range.html">Group Range Format</a></li>
    <li><a href="lsp.html">LSP Notification</a></li>
    <li><a href="enable.html">Enable Orders on Hold</a></li>
    <li><a href="billing.html">Convert to Billing Format</a></li>
    <li><a href="tf.html"><b>Toll-Free</b></a></li>
  </ul>
</div>

<h1>Create Table for Toll-Free by Bernie</h1>
<p>Enter Toll Free Numbers (one per line)</p>
<textarea id="numbersInput" rows="8" cols="50" onfocus="this.value=''; return false;"></textarea>
  <br><br>

 Start Date: <input type="date" id="startDate"><br><br>
  End Date: <input type="date" id="endDate"><br><br>

  <button id="formatBtn">Format</button>

  <h3>Output</h3>
  <pre id="output"></pre>

  <script>
    function normaliseNumber(num) {
      // Remove all non-digits
      const digits = num.replace(/\D/g, '');

      // Only handle 10-digit numbers starting with 0800 or 0508
      if (!/^(0800|0508)\d{6}$/.test(digits)) {
        return null;
      }

      // Insert hyphen after first 4 digits
      return digits.slice(0, 4) + '-' + digits.slice(4);
    }

    async function copyToClipboard(text) {
      try {
        if (navigator.clipboard && navigator.clipboard.writeText) {
          await navigator.clipboard.writeText(text);
        } else {
          // Fallback for older browsers
          const temp = document.createElement('textarea');
          temp.value = text;
          document.body.appendChild(temp);
          temp.select();
          document.execCommand('copy');
          document.body.removeChild(temp);
        }
      } catch (e) {
        console.error('Copy failed:', e);
      }
    }

    document.getElementById('formatBtn').addEventListener('click', async function () {
      const rawText = document.getElementById('numbersInput').value;
      const start = document.getElementById('startDate').value;
      const end   = document.getElementById('endDate').value;
      const outEl = document.getElementById('output');

      if (!start || !end) {
        const msg = 'Please enter both start and end date.';
        outEl.textContent = msg;
        await copyToClipboard(msg);
        return;
      }

      const rawNumbers = rawText
        .split(/[\n,]+/)       // split by newline or comma
        .map(s => s.trim())
        .filter(s => s.length > 0);

      const lines = [];

      rawNumbers.forEach(num => {
        const formatted = normaliseNumber(num);
        if (formatted) {
          lines.push(
            'Devoli Toll Free Number for ' +
            formatted +
            ' Part Month Credit from (' +
            start + ' - ' + end + ')'
          );
        } else {
          lines.push('Invalid or unsupported number: ' + num);
        }
      });

      const resultText = lines.join('\n');
      outEl.textContent = resultText;

      // Automatically copy result to clipboard
      await copyToClipboard(resultText);
    });
  </script>

</body>
</html>




